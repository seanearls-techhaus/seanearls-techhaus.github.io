<!DOCTYPE html>
<html>
<head>
    <title>Test Website</title>

    <script type="text/javascript">
        // Function to set a cookie
        function setCookie(name, value, days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + (value || "") + expires + "; path=/";
        }

        // Function to handle form submission
        function submitForm() {
            var email = document.getElementById('email-input').value;
            setCookie('userEmailCookieTest', email, 1); // Set the cookie with the entered email
            
            // Update Klaviyo identification with the new email
            _learnq.push(['identify', {
                '$email': email
            }]);

            // Track an event with Klaviyo
            var pageUrl = window.location.href;
            var metadata = {
                page_url: pageUrl
            };
            _learnq.push(['track', 'User Page Tracking', metadata]);

            // Redirect to the next page
            window.location.href = 'page2.html';
        }
    </script>

    <!-- Klaviyo tracking code -->
    <script type="text/javascript">
        // Include Klaviyo's JavaScript SDK
        var _learnq = _learnq || [];
        _learnq.push(['account', 'SEPBCg']);

        var pageUrl = window.location.href;

        // Define some dummy metadata
        var metadata = {
            page_url: pageUrl
        };

        // Identify a user
        _learnq.push(['identify', {
            '$email' : email, // the user's email
        }]);

        // Track an event with Klaviyo
        _learnq.push(['track', 'User Page Tracking', metadata]);
    </script>

    <script type="text/javascript" src="//static.klaviyo.com/onsite/js/klaviyo.js?company_id=SEPBCg"></script>

</head>
<body>
    <h1>Site 1 - Page 1</h1>

    <div class="klaviyo-form-TEwA9H"></div>

    <label for="email-input">Email:</label>
    <input type="email" id="email-input" name="email" required>

    <button onclick="submitForm();" type="button">
        Submit
    </button>
    
</body>
</html>
