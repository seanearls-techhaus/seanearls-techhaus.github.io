<!DOCTYPE html>
<html>
<head>
    <title>Test Website</title>

    <script type="text/javascript">
        // Function to set a cookie
        function setCookie(name, value, days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toUTCString();
            }
            var cookieString = name + "=" + (value || "") + expires + "; SameSite=None; Secure; path=/";
            
            document.cookie = cookieString;
        }
    </script>

</head>
<body>
    <h1>Site 1 - Page 1</h1>

    <div class="klaviyo-form-TEwA9H"></div>
    
    <script type="text/javascript">
        console.log('204pm');
        var _learnq = _learnq || [];

        _learnq.push(['account', 'SEPBCg']); // replace with your public API key

        // Define the onSubmitSuccess callback for the form.
        _learnq.push(['forms', {
            onSubmitSuccess: function ($form, response) {
                // Form submission was successful.
        
                // Get the email input field value.
                var email = $form.find('input[name="email"]').val();
        
                // Set a cookie with the email value.
                setCookie('userEmailKla', email, 1);
        
                // Push data to Klaviyo
                var pageUrl = window.location.href;
        
                var metadata = {
                    page_url: pageUrl
                };
        
                _learnq.push(['identify', {
                    '$email': email
                }]);
        
                _learnq.push(['track', 'User Page Tracking', metadata]);
        
                // Redirect to page2.html
                window.setTimeout(function() {
                    window.location.href = 'page2.html';
                }, 2000);
            }
        }]);

        // Load the Klaviyo scripts.
        (function () {
            var b = document.createElement('script');
            b.type = 'text/javascript';
            b.async = true;
            b.src = '//static.klaviyo.com/onsite/js/klaviyo.js?company_id=SEPBCg'; // replace with your public API key
            var a = document.getElementsByTagName('script')[0];
            a.parentNode.insertBefore(b, a);
        })();
    </script>
    
</body>
</html>
