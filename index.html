<!DOCTYPE html>
<html>
<head>
    <title>Test Website</title>

    <script type="text/javascript">
        // Function to set a cookie
        function setCookie(name, value, days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toUTCString();
            }
            var cookieString = name + "=" + (value || "") + expires + "; SameSite=None; Secure; path=/";
            
            document.cookie = cookieString;
        }
    </script>

    <script type="text/javascript" src="//static.klaviyo.com/onsite/js/klaviyo.js?company_id=SEPBCg" async></script>

    <!--<script type="text/javascript">
        !function(){if(!window.klaviyo){window._klOnsite=window._klOnsite||[];try{window.klaviyo=new Proxy({},{get:function(n,i){return"push"===i?function(){var n;(n=window._klOnsite).push.apply(n,arguments)}:function(){for(var n=arguments.length,o=new Array(n),w=0;w<n;w++)o[w]=arguments[w];var t="function"==typeof o[o.length-1]?o.pop():void 0,e=new Promise((function(n){window._klOnsite.push([i].concat(o,[function(i){t&&t(i),n(i)}]))}));return e}}})}catch(n){window.klaviyo=window.klaviyo||[],window.klaviyo.push=function(){var n;(n=window._klOnsite).push.apply(n,arguments)}}}}();
    </script>-->

</head>
<body>
    <h1>Site 1 - Page 1</h1>

    <div class="klaviyo-form-TEwA9H"></div>
    
    <script type="text/javascript">
        var klaviyo = window.klaviyo || [];

        //klaviyo.push(['publicApiKey', 'SEPBCg']); // replace with your public API key

        // Define the onSubmitSuccess callback for the form.
        klaviyo.push(['forms', {
            onSubmitSuccess: function ($form, response) {
                // Form submission was successful.
        
                // Get the email input field value.
                var email = $form.find('input[name="email"]').val();
        
                // Set a cookie with the email value.
                setCookie('userEmailKla', email, 1);
        
                // Push data to Klaviyo
                var pageUrl = window.location.href;
        
                var metadata = {
                    page_url: pageUrl
                };
        
                klaviyo.push(['identify', {
                    '$email': email
                }]);
        
                klaviyo.push(['track', 'User Page Tracking', metadata]);
        
            }
        }]);
    </script>
    <button onclick="window.location.href='page2.html'">Go to Page 2</button>
    
</body>
</html>
