<!DOCTYPE html>
<html>
<head>
    <title>Test Website</title>

    <script type="text/javascript">
        // Function to set a cookie
        function setCookie(name, value, days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toUTCString();
            }
            var cookieString = name + "=" + (value || "") + expires + "; SameSite=None; Secure; path=/";
            
            document.cookie = cookieString;
        }
    </script>
    <script type="text/javascript" src="//static.klaviyo.com/onsite/js/klaviyo.js?company_id=SEPBCg"></script>

</head>
<body>
    <h1>Site 1 - Page 1</h1>

    <div class="klaviyo-form-TEwA9H"></div>
    
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function(event) {

            var_learnq = window._learnq || [];
            _learnq.push(['account', 'SEPBCg']);
            console.log("Dom content loaded");

            var formElement = document.querySelector('.klaviyo-form-TEwA9H form');

            if (formElement) {
                formElement.addEventListener('submit', function(event) {
                    event.preventDefault();

                    var emailInput = formElement.querySelector('input[name="email"]');
                    var email = emailInput.value;

                    console.log('Email: ', email);
                    if (email) {
                        setCookie('userEmailKla', email, 1);

                        var pageUrl = window.location.href;

                        var metadata = {
                            page_url: pageUrl
                        };

                        _learnq.push(['identify', {
                            '$email': email
                        }]);

                        _learnq.push(['track', 'User Page Tracking', metadata]);

                        window.location.href = 'page2.html';
                    }
                    
                });
            }
        });
    </script>
    
</body>
</html>
